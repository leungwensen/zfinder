/*! pastry - v0.3.20150525 */!function(a){"use strict";function b(a,b,c){for(var d in a)b.call(c,a[d],d,a)}if(a=a||{},!a.pastry){var c,d,e,f={},g=Array,h=Function,i=Object,j=String,k="prototype",l="undefined",m=g[k],n=h[k],o=j[k],p={}.toString,q=m.slice,r=function(a){return q.call(a,1)},s=function(a,b,c){return a.apply(b,r(c))},t=function(a,b){return p.call(b)==="[object "+a+"]"},u=f.isArrayLike=function(a){return"object"==typeof a&&isFinite(a.length)},v=f.isFunction=function(a){return t("Function",a)},w=f.isNumber=function(a){return t("Number",a)},x=f.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},y=f.isPlainObject=function(a){return t("Object",a)},z=f.toArray=function(a){return u(a)?q.call(a):[]};f.index=function(a){return function(b,c,d){var e,f=b.length>>>0;if(0===f)return-1;if(d?0>d&&(d=Math.max(0,b.length+d)):d=a?0:b.length,a){for(e=d;e<b.length;e++)if(b[e]===c)return e}else for(e=d;e>=0;e--)if(b[e]===c)return e;return-1}},f.indexOf=m.indexOf?function(a){return s(m.indexOf,a,arguments)}:f.index(!0),f.lastIndexOf=m.lastIndexOf?function(a){return s(m.lastIndexOf,a,arguments)}:f.index(),c=f.each=f.forEach=m.forEach?function(a,c,d){return u(a)?s(m.forEach,a,arguments):(y(a)&&b(a,c,d),a)}:function(a,c,d){if(u(a))for(var e=a.length,f=0;e>f;f++)f in a&&c.call(d,a[f],f,a);else y(a)&&b(a,c,d);return a},f.eachReverse=function(a,b,c){if(a)for(var d=a.length-1;d>-1;d-=1)b.call(c,a[d],d,a);return a},f.every=m.every?function(a){return s(m.every,a,arguments)}:function(a,b,c){var d;for(d=0;d<a.length;d++)if(!b.call(c,a[d],d,a))return!1;return!0},f.filter=m.filter?function(a){return s(m.filter,a,arguments)}:function(a,b,d){var e=[];return c(a,function(c,f){b.call(d,c,f,a)&&e.push(c)}),e},f.map=m.map?function(a){return s(m.map,a,arguments)}:function(a,b,d){var e=[];return c(a,function(c,f){e.push(b.call(d,c,f,a))}),e},f.some=m.some?function(a){return s(m.some,a,arguments)}:function(a,b,c){var d;for(d=0;d<a.length;d++)if(b.call(c,a[d],d,a))return!0;return!1},f.reduce=m.reduce?function(a){return s(m.reduce,a,arguments)}:function(a,b,c){var d,e;for(c&&(e=c),d=0;d<a.length;d++)e=e?b(e,a[d],d,a):a[d];return e},f.reduceRight=m.reduceRight?function(a){return s(m.reduceRight,a,arguments)}:function(a,b,c){var d,e;for(c&&(e=c),d=a.length-1;d>=0;d--)e=e?b(e,a[d],d,a):a[d];return e},f.trim=o.trim?function(a){return a.trim()}:function(a){return a.replace(/^\s+|\s+$/g,"")},f.trimLeft=o.trimLeft?function(a){return a.trimLeft()}:function(a){return a.replace(/^\s+/g,"")},f.trimRight=o.trimRight?function(a){return a.trimRight()}:function(a){return a.replace(/\s+$/g,"")},f.toInt=function(a,b){return parseInt(a,b||10)},f.lc=function(a){return(a+"").toLowerCase()},e=f.uc=function(a){return(a+"").toUpperCase()},f.hasSubString=function(a,b){return a.indexOf(b)>-1},f.capitalize=function(a){return a+="",e(a.charAt(0))+a.substr(1)},c(["Array","Arguments","Boolean","Date","Error","RegExp","String"],function(a){f["is"+a]=function(b){return t(a,b)}}),g.isArray&&(f.isArray=g.isArray),f.isNaN=function(a){return w(a)&&a!==+a},f.isFinite=function(a){return w(a)&&isFinite(a)&&!isNaN(a)},f.isUndefined=function(a){return void 0===a},f.isNull=function(a){return null===a},f.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=c||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=new Array(d),f=0;d>f;f++,a+=c)e[f]=a;return e},f.flatten=function(a){a=a||[];for(var b=[],c=0,d=a.length;d>c;++c)u(a[c])?b=b.concat(a[c]):b[b.length]=a[c];return b},f.merge=function(a){return c(r(arguments),function(b){if(b)for(var c in b)p.call(b[c])!==p.call(a[c])?a[c]=b[c]:y(b[c])?(a[c]=a[c]||{},f.merge(a[c],b[c])):a[c]=b[c]}),a},f.extend=function(a){return c(r(arguments),function(b){if(b)for(var c in b)a[c]=b[c]}),a},f.remove=function(a,b,c){var d,e=a.length;return w(b)?(d=a.slice((c||b)+1||e),a.length=0>b?e+b:b,a.push.apply(a,d)):a},f.keys=i.keys?function(a){return i.keys(a)}:function(a){var b=[];return v(a)?c(a,function(a,c){c!==k&&b.push(c)}):c(a,function(a,c){b.push(c)}),b},f.invert=function(a){var b={};return c(a,function(a,c){b[a]=c}),b},f.values=function(a){var b=[];return c(a,function(a){b.push(a)}),b},f.hasKey=function(a,b){return a.hasOwnProperty(b)},d=f.hasValue=function(a,b){return f.indexOf(f.values(a),b)>-1},f.uniq=function(a){var b=[];return c(a,function(a){d(b,a)||b.push(a)}),b},f.union=function(){var a=[],b=z(arguments);return c(b,function(b){a.concat(b)}),f.uniq(a)},f.difference=function(a){var b=f.flatten(r(arguments));return f.filter(a,function(a){return!d(b,a)})},f.intersect=function(a,b){var e=[];return c(a,function(a){d(b,a)&&e.push(a)}),e},f.destroy=function(a){for(var b in a)a.hasOwnProperty(b)&&delete a[b];a.prototype=a.__proto__=null,a=null},f.clone=function(a){return x(a)?u(a)?z(a):f.extend({},a):a},f.bind=n.bind?function(a){return s(n.bind,a,arguments)}:function(b,c){if(v(c)&&v(b)){var d=z(arguments).slice(2),e=function(){},g=function(){return b.apply(this instanceof e&&c?this:c||a,d.concat(arguments))};return e[f]=b[f],g[f]=new e,g}},f.getAny=function(){var a,b,c=f.flatten(z(arguments));for(a=0;a<c.length;a++)try{b=c[a]();break}catch(d){}return b},f.uuid=function(a){return a=a||"",a+"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8,d=c.toString(16);return d})},f.mixin=function(a,b){c(a,function(a,c){if(f[c]&&!b)throw"pastry."+c+" already exists";f[c]=a})},f.setGLOBAL=function(b,c){typeof exports!==l&&(exports[b]=c),a[b]=c},c(["P","pastry","PASTRY"],function(a){f.setGLOBAL(a,f)}),typeof exports!==l&&typeof module!==l&&module.exports&&(module.exports=f),f.CONFIG=f.merge({defaultLocale:"en_us",locale:"en_us"},"undefined"!=typeof PASTRY_CONFIG?PASTRY_CONFIG:{})}}(this),function(a){"use strict";var b=a.pastry,c=function(a){a=a||this;var c=a._events={};return a.on=function(b,d,e){var f=c[b]||(c[b]=[]);return f.push({callback:d,context:e}),a},a.off=function(b,d){b||(c={});var e=c[b]||[],f=e.length;if(d)for(;f>0;)f--,e[f].callback===d&&e.splice(f,1);else e=[];return a},a.emit=function(){var d=b.toArray(arguments),e=c[d.shift()]||[];return b.each(e,function(a){if(!a.callback)throw console.error(a,e),"event callback is not defined";a.callback.apply(a.context,d)}),a},a.trigger=a.emit,a};c(b),b.event=c}(this);var define;!function(a,b){"use strict";if(!define){var c,d=a.pastry,e=d.event,f=d.each,g=function(a){var b=this;return b.initialise(a),b},h=g._data={},i=h.moduleByUri={},j=h.exportsByUri={},k=h.executedByUri={},l=h.queueByUri={};e(g),g.prototype={initialise:function(a){var b,c,e,f=this;return d.extend(f,a),g.emit("module-initialised",f),(c=f.uri)&&(i[c]||(i[c]=f),l[c]||(l[c]=f)),(b=f.id)&&(i[b]||(i[b]=f)),(e=f.relativeUri)&&(i[e]||(i[e]=f),l[e]||(l[f.relativeUri]=f)),f},processDeps:function(){var a=this;return g.emit("module-depsProcessed",a),a},execute:function(){var a=this,c=[];if("exports"in a)return delete l[a.uri],delete l[a.relativeUri],a;if(d.every(a.deps,function(a){return!!k[a]})){var e=a.factory,h=a.uri,i=a.id,m=a.relativeUri;f(a.deps,function(a){c.push(j[a])}),a.exports=j[h]=j[i]=j[m]=d.isFunction(e)?e.apply(b,c):e,k[h]=k[i]=k[m]=!0,delete l[h],g.emit("module-executed",a)}return a}},g.on("module-executed",function(){f(l,function(a){a instanceof g&&a.execute()})}),define=a.define=g.define=function(){var a,c=d.toArray(arguments),e=d.isString(c[0])?c.shift():b,f=c.length>1?c.shift():[],h=c[0],i={id:e,uri:e,deps:f,factory:h};g.emit("module-metaGot",i),a=new g(i).processDeps().execute(),g.emit("module-defined",a)},define.amd={},c=define,define("pastry/Module",function(){return g}),define("pastry/pastry",function(){return d}),define("pastry/event/event",function(){return d.event}),d.setGLOBAL("require",c)}}(this),define("pastry/module/path",["pastry/pastry","pastry/Module"],function(a,b){"use strict";function c(a){return a.match(k)[0]}function d(a){for(a=a.replace(l,"/"),a=a.replace(o,"$1/");a.match(m);)a=a.replace(m,"/");return a}function e(a){var b=a.length-1,c=a.charCodeAt(b);return 35===c?a.substring(0,b):".js"===a.substring(b-2)||a.indexOf("?")>0||47===c?a:a+".js"}function f(b){var c=r.alias;return c&&a.isString(c[b])?c[b]:b}function g(b){var c,d=r.paths;return d&&(c=b.match(p))&&a.isString(d[c[1]])&&(b=d[c[1]]+c[2]),b}function h(a,b){var e,f=a.charCodeAt(0);if(j.test(a))e=a;else if(46===f)e=(b?c(b):r.cwd)+a;else if(47===f){var g=r.cwd.match(q);e=g?g[0]+a.substring(1):a}else e=r.base+a;return 0===e.indexOf("//")&&(e=t.protocol+e),d(e)}function i(a,b){if(!a)return"";a=f(a),a=g(a),a=f(a),a=e(a),a=f(a);var c=h(a,b);return c=f(c)}var j=/^\/\/.|:\//,k=/[^?#]*\//,l=/\/\.\//g,m=/\/[^/]+\/\.\.\//,n=/^(about|blob):/,o=/([^:/])\/+\//g,p=/^([^/:]+)(\/.+)$/,q=/^.*?\/\/.*?\//,r=b._data,s=document,t=location,u=t.href,v=s.scripts,w=s.getElementById("moduleLoader")||v[v.length-1],x=w.hasAttribute?w.src:w.getAttribute("src",4);return r.cwd=!u||n.test(u)?"":c(u),r.path=x,r.dir=r.base=c(x||r.cwd),{id2Uri:i}}),define("pastry/module/request",["pastry/pastry","pastry/Module"],function(a,b){"use strict";function c(c,d,e){function f(b){c.onload=c.onerror=c.onreadystatechange=null,c=null,a.isFunction(d)&&d(b)}var g="onload"in c;g?(c.onload=f,c.onerror=function(){b.emit("error",{uri:e,node:c}),f(!0)}):c.onreadystatechange=function(){/loaded|complete/.test(c.readyState)&&f()}}function d(d,h,i,j){var k=e.createElement("script");if(i){var l=a.isFunction(i)?i(d):i;l&&(k.charset=l)}var m=a.isFunction(j)?j(d):j;m!==!1&&(k.crossorigin=m),c(k,h,d),k.async=!0,k.src=d,b.currentlyAddingScript=k,g?f.insertBefore(k,g):f.appendChild(k),b.currentlyAddingScript=null}var e=document,f=e.head||e.getElementsByTagName("head")[0]||e.documentElement,g=f.getElementsByTagName("base")[0];return d}),define("pastry/module/loader",["pastry/pastry","pastry/Module","pastry/module/path","pastry/module/request"],function(a,b,c,d){"use strict";function e(){if(b.currentlyAddingScript)return b.currentlyAddingScript.src;if(k.currentScript)return k.currentScript.src;var a;try{throw new Error}catch(c){a=c.stack,!a&&l.opera&&(a=(String(c).match(/of linked script \S+/g)||[]).join(" "))}if(a)return a=a.split(/[@ ]/g).pop(),a="("===a[0]?a.slice(1,-1):a,a.replace(/(:\d+)?:\d+$/i,"");if(f&&"interactive"===f.readyState)return f.src;for(var d,e=k.getElementsByTagName("script"),g=0;d=e[g++];)if("interactive"===d.readyState)return f=d,d.src}var f,g=b._data,h=g.moduleByUri,i=g.executedByUri,j=g.loadingByUri={},k=document,l=window,m=c.id2Uri,n=a.each;b.resolve=m,b.request=d,b.on("module-metaGot",function(b){var c=e();b.uri=c?c:g.cwd,(""===c||a.isString(c)&&c===g.cwd)&&(b.id||(b.uri=g.cwd+("#"+a.uuid())))}).on("module-initialised",function(b){var c,d;a.isString(b.uri)&&b.uri.indexOf("/")>-1||(b.uri=m(b.id)),c=b.uri,(d=b.id)&&(b.relativeUri=c.indexOf(d+".")>-1?c:m("./"+b.id,b.uri))}).on("module-depsProcessed",function(a){n(a.deps,function(b,c){var e;e=h[b]?b:m(b,a.relativeUri||a.uri),a.deps[c]=e,h[e]||j[e]||i[e]||(d(e),j[e]=!0)})})}),define("pastry/fmt/sprintf",["pastry/pastry"],function(a){"use strict";var b=/%(\+)?([0 ]|'(.))?(-)?([0-9]+)?(\.([0-9]+))?([%bcdfosxX])/g,c=a.isUndefined,d=a.some,e=Math.abs,f=a.toInt,g=function(g){if(!a.isString(g))throw"sprintf: The first arguments need to be a valid format string.";for(var h,i=[],j=1,k=a.toArray(arguments);h=b.exec(g);){if(j>=k.length&&"%"!==h[8])throw"sprintf: At least one argument was missing.";i[i.length]={begin:h.index,end:h.index+h[0].length,sign:"+"===h[1],negative:parseFloat(k[j])<0?!0:!1,padding:c(h[2])?" ":"'"===h[2].substring(0,1)?h[3]:h[2],alignLeft:"-"===h[4],width:c(h[5])?!1:h[5],precision:c(h[7])?!1:h[7],type:h[8],data:"%"!==h[8]?String(k[j++]):!1}}var l,m,n,o,p="",q=0;for(l=0;l<i.length;l++){switch(p+=g.substring(q,i[l].begin),q=i[l].end,n="",i[l].type){case"%":n="%";break;case"b":n=e(f(i[l].data)).toString(2);break;case"c":n=String.fromCharCode(e(f(i[l].data)));break;case"d":n=String(e(f(i[l].data)));break;case"f":n=i[l].precision===!1?String(e(parseFloat(i[l].data))):e(parseFloat(i[l].data)).toFixed(i[l].precision);break;case"o":n=e(f(i[l].data)).toString(8);break;case"s":n=i[l].data.substring(0,i[l].precision?i[l].precision:i[l].data.length);break;case"x":n=e(f(i[l].data)).toString(16).toLowerCase();break;case"X":n=e(f(i[l].data)).toString(16).toUpperCase();break;default:throw'sprintf: Unknown type "'+i[l].type+'" detected. This should never happen. Maybe the regex is wrong.'}if("%"!==i[l].type){if(i[l].width!==!1&&i[l].width>n.length)for(o=n.length,m=0;m<i[l].width-o;++m)n=i[l].alignLeft===!0?n+i[l].padding:i[l].padding+n;d(["b","d","o","f","x","X"],function(a){return a===i[l].type})&&(i[l].negative===!0?n="-"+n:i[l].sign===!0&&(n="+"+n)),p+=n}else p+=n}return p+=g.substring(q,g.length)};return a.sprintf=g}),define("pastry/fmt/vsprintf",["pastry/pastry","pastry/fmt/sprintf"],function(a,b){"use strict";var c=function(a,c){return c.unshift(a),b.apply(null,c)};return a.vsprintf=c}),define("pastry/fmt/camelCase",["pastry/pastry"],function(a){"use strict";function b(b){return b.replace(/^[_.\- ]+/,"").replace(/[_.-](\w|$)/g,function(b,c){return a.uc(c)})}function c(b,c){return c=c||"_",b.replace(/([a-z])([A-Z])/g,function(b,d,e){return d+c+a.lc(e)})}function d(e,f,g){return e&&a.isObject(e)?!e||a.isDate(e)||a.isRegExp(e)?e:a.isArray(e)?a.map(e,function(a){return d(a,f,g)}):a.reduce(a.keys(e),function(a,h){var i=f?c(h,g):b(h);return a[i]=d(e[h],f,g),a},{}):e}return a.camelCase={camelise:function(c){return a.isString(c)?b(c):a.isObject(c)?d(c):c},uncamelise:function(b,e){return a.isString(b)?c(b,e):a.isObject(b)?d(b,!0,e):b}}}),define("pastry/color/hexByName",[],function(){"use strict";var a={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",burntsienna:"#ea7e5d",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return a}),define("pastry/oop/c3mro",["pastry/pastry"],function(a){"use strict";function b(a){return a.slice(0)}function c(b,c){var d=!0;return a.some(c,function(a){e(a,b)>0&&(d=!1)}),d&&a.each(c,function(a){0===e(a,b)&&a.shift()}),d}function d(a){for(var b=[],d=0;a.length;){var e=a.shift();if(e.length){if(c(e[0],a))b.push(e.shift()),d=0;else if(d+=1,d===a.length)throw"Bad Linearization";e.length&&a.push(e)}}return b}var e=a.indexOf;return a.c3mroMerge=function(){var c=a.map(a.toArray(arguments),b);return d(c)}}),define("pastry/oop/declare",["pastry/pastry","pastry/oop/c3mro"],function(a,b){"use strict";return a.declare=function(){var c,d,e="_linearization",f=a.toArray(arguments),g=a.isString(f[0])?f.shift():"",h=f.length>1?f.shift():[],i=f[0]?f.shift():{},j=[],k=function(){},l=!1,m=function(){};for(h=a.isArray(h)?h:[h],a.each(h,function(a){a[e]=a[e]||[a],j.push(a[e])}),j.length&&(j.push(h),j=b.apply(null,j)),d=i.constructor,d!==Object.prototype.constructor&&(l=!0,m=d),m[e]=[m].concat(j),m.parents=j.slice(0),i.constructor=m;c=j.shift();)i=a.extend({},c.prototype,i),k.prototype=i,l||(i.constructor=m),i=new k;return m.className=g,m.prototype=i,m.prototype.constructor=m,m}}),define("pastry/color/Color",["pastry/pastry","pastry/color/hexByName","pastry/oop/declare"],function(a,b,c){"use strict";function d(b,c,d){return b=Number(b),a.isFinite(b)?c>b?c:b>d?d:b:d}function e(a,b,c){0>c&&++c,c>1&&--c;var d=6*c;return 1>d?a+(b-a)*d:1>2*c?b:2>3*c?a+(b-a)*(2/3-c)*6:a}function f(a,b,c,d){var e,f,g=Math.max(a,b,c),h=Math.min(a,b,c),i=(g+h)/2;if(g===h)e=f=0;else{var j=g-h;switch(f=i>.5?j/(2-g-h):j/(g+h),g){case a:e=(b-c)/j+(c>b?6:0);break;case b:e=(c-a)/j+2;break;case c:e=(a-b)/j+4}e/=6}return[e,f,i,d]}var g,h=a.lc,i=Math.round,j={r:255,g:255,b:255,a:1},k=function(a){var b=this;a&&b.initialise(a)};return a.extend(k,{hexByName:b,makeGrey:function(a,b){return k.fromArray([a,a,a,b])},blendColors:function(b,c,d,e){var f=e||new k;return a.each(["r","g","b","a"],function(a){f[a]=b[a]+(c[a]-b[a])*d,"a"!==a&&(f[a]=Math.round(f[a]))}),f.sanitize()},fromHex:function(b,c){var d=c||new k,e=4===b.length?4:8,f=(1<<e)-1;return b=Number("0x"+b.substr(1)),a.isNaN(b)?null:(a.each(["b","g","r"],function(a){var c=b&f;b>>=e,d[a]=4===e?17*c:c}),d.a=1,d)},fromRgb:function(a,b){var c=h(a).match(/^rgba?\(([\s\.,0-9]+)\)/);return c&&k.fromArray(c[1].split(/\s*,\s*/),b)},fromHsl:function(a,b){var c=h(a).match(/^hsla?\(([\s\.,0-9]+)\)/);if(c){var d=c[2].split(/\s*,\s*/),f=d.length,g=(parseFloat(d[0])%360+360)%360/360,i=parseFloat(d[1])/100,j=parseFloat(d[2])/100,l=.5>=j?j*(i+1):j+i-j*i,m=2*j-l,n=[256*e(m,l,g+1/3),256*e(m,l,g),256*e(m,l,g-1/3),1];return 4===f&&(n[3]=d[3]),k.fromArray(n,b)}},fromArray:function(a,b){var c=b||new k;return c.set(Number(a[0]),Number(a[1]),Number(a[2]),Number(a[3])),isNaN(c.a)&&(c.a=1),c.sanitize()},fromString:function(a,b){var c=k.hexByName[a];return c&&k.fromHex(c,b)||k.fromRgb(a,b)||k.fromHex(a,b)||k.fromHsl(a,b)}}),g=a.extend(j,{constructor:k,initialise:function(b){var c=this;return a.isString(b)?k.fromString(b,this):a.isArray(b)?k.fromArray(b,this):(c.set(b.r,b.g,b.b,b.a),b instanceof k||c.sanitize()),c},set:function(a,b,c,d){var e=this;return e.r=a,e.g=b,e.b=c,e.a=d,e},sanitize:function(){var a=this;return a.r=i(d(a.r,0,255)),a.g=i(d(a.g,0,255)),a.b=i(d(a.b,0,255)),a.a=d(a.a,0,1),a},toRgba:function(){var a=this;return[a.r,a.g,a.b,a.a]},toHsla:function(){var a=this;return f(a.r,a.g,a.b,a.a)},toHex:function(){var b=this,c=a.map(["r","g","b"],function(a){var c=b[a].toString(16);return c.length<2?"0"+c:c});return"#"+c.join("")},toCss:function(a){var b=this,c=b.r+", "+b.g+", "+b.b;return(a?"rgba("+c+","+b.a:"rgb("+c)+")"},toString:function(){return this.toCss(!0)},toGrey:function(){var a=this,b=i((a.r+a.g+a.b)/3);return k.makeGrey(b,a.a)},destroy:function(){a.destroy(this)}}),a.Color=c("pastry/color/Color",g)}),define("pastry/fmt/date",["pastry/pastry"],function(a){"use strict";function b(a){return 10>a?"0"+a:a}function c(a){var b=a+"",c=b.length;return 3===c?b:2===c?"0"+b:"00"+b}return a.fmtDate=function(d,e){if(a.isDate(d))return e=e||"{FullYear}-{Month}-{Date}T{Hours}:{Minutes}:{Seconds}Z",e.replace(/\{(\w+)\}/g,function(a,e){var f="get"+("Year"===e?e:"UTC"+e),g=d[f]()+("Month"===e?1:0);return"Milliseconds"===e?c(g):b(g)});throw"not a Date instance"}}),define("pastry/encoding/json",["pastry/pastry","pastry/fmt/date"],function(pastry,fmtDate){"use strict";function exportJSON(a){return pastry.json=a,pastry.setGLOBAL("JSON",a),a}if("undefined"!=typeof JSON&&JSON&&JSON.parse&&JSON.stringify)return exportJSON(JSON);var D2JSON=Date.prototype.toJSON,isFunction=pastry.isFunction,isString=pastry.isString,isNumber=pastry.isNumber;isFunction(D2JSON)||(pastry.each([String.prototype,Number.prototype,Boolean.prototype],function(a){a.toJSON=function(){return this.valueOf()}}),D2JSON=function(){return isFinite(this.valueOf())?fmtDate(this):null});var undef,escapeString=function(a){return('"'+a.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},shim={parse:function(str,strict){if(strict&&!/^([\s\[\{]*(?:"(?:\\.|[^"])*"|-?\d[\d\.]*(?:[Ee][+-]?\d+)?|null|true|false|)[\s\]\}]*(?:,|:|$))+$/.test(str))throw"Invalid characters in JSON";return eval("("+str+")")},stringify:function(a,b,c){function d(a,e,f){b&&(a=b(f,a));var g;if(isNumber(a))return isFinite(a)?a+"":"null";if(pastry.isBoolean(a))return a+"";if(null===a)return"null";if(isString(a))return escapeString(a);if(isFunction(a)||!a)return undef;if(isFunction(a.toJSON))return d(a.toJSON(f),e,f);if(pastry.isDate(a))return fmtDate(a);if(a.valueOf()!==a)return d(a.valueOf(),e,f);var h=c?e+c:"",i=c?" ":"",j=c?"\n":"";if(pastry.isArray(a)){var k=a.length,l=[];for(f=0;k>f;f++){var m=a[f];g=d(m,h,f),isString(g)||(g="null"),l.push(j+h+g)}return"["+l.join(",")+j+e+"]"}var n=[];for(f in a){var o;if(a.hasOwnProperty(f)){if(isNumber(f))o='"'+f+'"';else{if(!isString(f))continue;o=escapeString(f)}if(g=d(a[f],h,f),!isString(g))continue;n.push(j+h+o+":"+i+g)}}return"{"+n.join(",")+j+e+"}"}return isString(b)&&(c=b,b=null),d(a,"","")}};return exportJSON(shim)}),define("pastry/html/escape",["pastry/pastry"],function(a){"use strict";function b(b){function c(a){return b[a]}var d="(?:"+a.keys(b).join("|")+")",e=new RegExp(d),f=new RegExp(d,"g");return function(a){return a=null===a?"":""+a,e.test(a)?a.replace(f,c):a}}var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},d=a.invert(c);return{escape:a.escape=b(c),unescape:a.unescape=b(d)}}),define("pastry/text/template",["pastry/pastry","pastry/html/escape"],function(a,b){"use strict";function c(a,b,c,d,e,f,g){return b?{"\n":"\\n","\r":"\\r","	":"\\t"," ":" "}[b]||"\\"+b:c?(d=h(d),"="===c?"'+_e("+d+")+'":"'+("+d+"==null?'':"+d+")+'"):e&&f&&g?"';"+h(f)+" _s+='":void 0}function d(a){return a.replace(i,c).replace(/\\n\s*/g,"")}var e,f={},g={},h=a.trim,i=/([\s'\\])(?!(?:[^{]|\{(?!%))*%\})|(?:\{%(=|#)([\s\S]+?)%\})|(?:(\{%)([\s\S]+?)(%\}))/g;return a.extend(g,b),a.template=e={helper:g,parse:d,compile:function(b){return a.isString(b)?f[b]||(f[b]=new Function("obj","helper","ne","var _e=ne?function(s){return s;}:helper.escape,print=function(s,e){_s+=e?(s==null?'':s):_e(s);};obj=obj||{};with(obj){_s='"+d(b)+"';}return _s;")):b},render:function(a,b,c){return c=c||{},e.compile(a)(b,e.helper,c.ne)}}}),define("pastry/bom/utils",["pastry/pastry"],function(a){"use strict";function b(a,b,c){a[b]=o(c)}function c(a,c,d){var e=c.match(d);e&&b(a,e[0].match(/\w*/)[0],e[1]||0)}function d(b){if(b){var c=a.lc(b).match(/mac|win|linux|ipad|ipod|iphone|android/);return a.isArray(c)?c[0]:c}}function e(a){return{flash:function(){var b,c=0,d=13;if(a&&a.length)b=a["Shockwave Flash"],b&&b.description&&(c=b.description.match(/\b(\d+)\.\d+\b/)[1]||c);else for(;d--;)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+d),c=d;break}catch(e){}return o(c)}()}}function f(d){if(d){d=a.lc(d);var e,f,g={};return a.each([/msie ([\d.]+)/,/firefox\/([\d.]+)/,/chrome\/([\d.]+)/,/crios\/([\d.]+)/,/opera.([\d.]+)/,/adobeair\/([\d.]+)/],function(a){c(g,d,a)}),g.crios&&(g.chrome=g.crios),f=d.match(/version\/([\d.]+).*safari/),f&&b(g,"safari",f[1]||0),f=d.match(/version\/([\d.]+).*mobile.*safari/),f&&b(g,"mobilesafari",f[1]||0),a.each([/trident\/([\d.]+)/,/gecko\/([\d.]+)/,/applewebkit\/([\d.]+)/,/webkit\/([\d.]+)/,/presto\/([\d.]+)/],function(a){c(g,d,a)}),e=g.msie,6===e?g.trident=4:(7===e||8===e)&&(g.trident=5),g}}var g,h,i=window,j=navigator||{},k=j.userAgent,l=j.platform,m=j.plugins,n={},o=a.toInt;return h=e(m),g=d(l)||d(k)||"unknown",a.extend(n,f(k),h),{host:location.host,platform:d,plugins:h,userAgent:k,versions:n,isWebkit:!!n.webkit,isIE:!!n.msie,isOpera:!!i.opera,isApple:g.mac||g.ipad||g.ipod||g.iphone}}),define("pastry/dom/utils",["pastry/pastry"],function(a){"use strict";var b=document,c=b.documentElement,d=b.createElement("div");return{hasTextContent:"textContent"in d,hasClassList:"classList"in d,hasDataSet:"dataset"in d,canDnD:"draggable"in d,isQuirks:"backcompat"===a.lc(b.compatMode)||5===b.documentMode,testDiv:d,contains:"compareDocumentPosition"in c?function(a,b){return 16===(16&b.compareDocumentPosition(a))}:function(a,d){return d=d===b||d===window?c:d,d!==a&&d.contains(a)},isDomNode:function(a){var b;return a&&"object"==typeof a&&(b=a.nodeType)&&(1===b||9===b)}}}),define("pastry/dom/query",["pastry/pastry","pastry/dom/utils"],function(a,b){"use strict";function c(a){return a?i(a)?d(a)[0]:!a[q]&&h(a)?a[0]:a:o}function d(b,d){var e,f=c(d);if(!f||!b)return[];if(b===p||j(b))return!d||b!==p&&j(f)&&k(b,f)?[b]:[];if(11===b.nodeType)return a.toArray(b.childNodes);if(b&&h(b))return a.flatten(b);if(i(b)&&(e=r.exec(b))){if(e[1])return[f.getElementById(e[1])];if(e[2])return g(f.getElementsByTagName(e[2]));if(e[3])return g(f.getElementsByClassName(e[3]))}return b&&(b.document||b[q]&&9===b[q])?d?[]:[b]:g(f.querySelectorAll(b))}function e(a,b){return d(a,b)[0]}function f(b,c){if(n)return m.call(b,c);var e,f=b.parentNode;return f||n||(f=document.createDocumentFragment(),f.appendChild(b)),e=d(c,f),a.some(e,function(a){return a===b})}var g=a.toArray,h=a.isArrayLike,i=a.isString,j=b.isDomNode,k=b.contains,l=b.testDiv,m=l.matches||l.webkitMatchesSelector||l.mozMatchesSelector||l.msMatchesSelector||l.oMatchesSelector,n=m&&m.call(l,"div"),o=document,p=window,q="nodeType",r=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,s={};return a.extend(s,{all:d,one:e,match:f})}),define("pastry/dom/class",["pastry/pastry","pastry/dom/utils","pastry/dom/query"],function(a,b,c){"use strict";function d(b){if(a.isString(b)){if(b&&!g.test(b))return k[0]=b,k;var c=b.split(g);return c.length&&!c[0]&&c.shift(),c.length&&!c[c.length-1]&&c.pop(),c}return b?a.filter(b,function(a){return a}):[]}function e(a){return i+a+i}var f,g=/\s+/,h="className",i=" ",j=b.hasClassList,k=[""];return f={contains:function(b,d){return b=c.one(b),d=a.trim(d),j?b.classList.contains(d):e(b[h]).indexOf(e(d))>=0},add:function(b,f){if(b=c.one(b),f=d(f),j)a.each(f,function(a){b.classList.add(a)});else{var g,k,l=b[h];l=l?e(l):i,g=l.length,a.each(f,function(a){a&&l.indexOf(e(a))<0&&(l+=a+i)}),k=l.length,k>g&&(b[h]=l.substr(1,k-2))}},remove:function(b,f){if(b=c.one(b),f=d(f),j)a.each(f,function(a){b.classList.remove(a)});else{var g=e(b[h]);a.each(f,function(a){g=g.replace(e(a),i)}),g=a.trim(g),b[h]!==g&&(b[h]=g)}},clear:function(a){a=c.one(a),a[h]=""},toggle:function(b,e){b=c.one(b),e=d(e),j?a.each(e,function(a){b.classList.toggle(a)}):a.each(e,function(a){f[f.contains(b,a)?"remove":"add"](b,a)})}}}),define("pastry/dom/event",["pastry/pastry","pastry/dom/query","pastry/dom/utils"],function(a,b,c){"use strict";function d(a,c,e){if(a=b.one(a),a.addEventListener)a.addEventListener(c,e,!1);else{e.$$guid||(e.$$guid=d.guid++),a.events||(a.events={});var g=a.events[c];g||(g=a.events[c]={},a["on"+c]&&(g[0]=a["on"+c])),g[e.$$guid]=e,a["on"+c]=f}}function e(a,c,d){var e=d._delegateWrapper;a=b.one(a),a.removeEventListener?(a.removeEventListener(c,d,!1),a.removeEventListener(c,e,!1)):a.events&&a.events[c]&&(delete a.events[c][d.$$guid],delete a.events[c][e.$$guid])}function f(a){var b=!0,c=this;a=a||g((k.parentWindow||l).event);var d=c.events[a.type];for(var e in d)c.$$handleEvent=d[e],c.$$handleEvent(a)===!1&&(b=!1);return b}function g(a){return a.preventDefault=g.preventDefault,a.stopPropagation=g.stopPropagation,a}function h(f,g,h,j,k,l){function m(a){(a.delegateTarget=i(f,a.target,h))&&(l===!0&&e(f,g,m),j.call(f,a))}if(a.isFunction(h))return void d(f,g,h);if(f=b.one(f),!c.isDomNode(f))throw"cannot bind events to non-elements: "+f;return j._delegateWrapper=m,d(f,g,m,k||!1),j}function i(a,c,d){for(;c&&c!==a;){if(b.match(c,d))return c;c=c.parentElement}return null}function j(a,b,c,d,e){h(a,b,c,d,e,!0)}var k=document,l=window;return d.guid=1,g.preventDefault=function(){this.returnValue=!1},g.stopPropagation=function(){this.cancelBubble=!0},{on:h,once:j,off:e}}),define("pastry/dom/hotkey",["pastry/pastry","pastry/bom/utils","pastry/dom/class","pastry/dom/event"],function(a,b,c,d){"use strict";function e(a){var b=a.which;if("keypress"===a.type){var c=String.fromCharCode(b);return a.shiftKey||(c=L(c)),c}return B[b]?B[b]:C[b]?C[b]:L(String.fromCharCode(b))}function f(a,b){return a.sort().join(",")===b.sort().join(",")}function g(a){a=a||{};var b,c=!1;for(b in H)a[b]?c=!0:H[b]=0;c||(K=!1)}function h(a){return M(["shift","ctrl","alt","meta"],a)>-1}function i(a,b,c,d,e,g){var i,j,k=[],l=c.type;if(!F[a])return[];for("keyup"===l&&h(a)&&(b=[a]),i=0;i<F[a].length;++i)if(j=F[a][i],(d||!j.seq||H[j.seq]===j.level)&&l===j.action&&("keypress"===l&&!c.metaKey&&!c.ctrlKey||f(b,j.modifiers))){var m=!d&&j.combo===e,n=d&&j.seq===d&&j.level===g;(m||n)&&F[a].splice(i,1),k.push(j)}return k}function j(a){var b=[];return N(["shift","alt","ctrl","meta"],function(c){a[c+"Key"]&&b.push(c)}),b}function k(a){return a.preventDefault?void a.preventDefault():void(a.returnValue=!1)}function l(a){return a.stopPropagation?void a.stopPropagation():void(a.cancelBubble=!0)}function m(a,b,c,d){x.stop(b,b.target||b.srcElement,c,d)||a(b,c)===!1&&(k(b),l(b))}function n(a,b,c){var d,e=i(a,b,c),f={},j=0,k=!1;for(d=0;d<e.length;++d)e[d].seq&&(j=Math.max(j,e[d].level));for(d=0;d<e.length;++d)if(e[d].seq){if(e[d].level!==j)continue;k=!0,f[e[d].seq]=1,m(e[d].callback,c,e[d].combo,e[d].seq)}else k||m(e[d].callback,c,e[d].combo);var l="keypress"===c.type&&J;c.type!==K||h(a)||l||g(f),J=k&&"keydown"===c.type}function o(b){a.isNumber(b.which)||(b.which=b.keyCode);var c=e(b);if(c)return"keyup"===b.type&&I===c?void(I=!1):void x.handleKey(c,j(b),b)}function p(){if(!y){y={};for(var a in B)a>95&&112>a||B.hasOwnProperty(a)&&(y[B[a]]=a)}return y}function q(a,b,c){return c||(c=p()[a]?"keydown":"keypress"),"keypress"===c&&b.length&&(c="keydown"),c}function r(a){return"+"===a?["+"]:a.split("+")}function s(a,b){var c,d,e,f=[];for(c=r(a),e=0;e<c.length;++e)d=c[e],E[d]&&(d=E[d]),b&&"keypress"!==b&&D[d]&&(d=D[d],f.push("shift")),h(d)&&f.push(d);return b=q(d,f,b),{key:d,modifiers:f,action:b}}function t(){clearTimeout(z),z=setTimeout(g,1e3)}function u(a,b,c,d){function f(b){return function(){K=b,++H[a],t()}}function h(b){m(c,b,a),"keyup"!==d&&(I=e(b)),setTimeout(g,10)}H[a]=0;for(var i=0;i<b.length;++i){var j=i+1===b.length,k=j?h:f(d||s(b[i+1]).action);v(b[i],k,d,a,i)}}function v(a,b,c,d,e){G[a+":"+c]=b,a=a.replace(/\s+/g," ");var f,g=a.split(" ");return g.length>1?void u(a,g,b,c):(f=s(a,c),F[f.key]=F[f.key]||[],
i(f.key,f.modifiers,{type:f.action},d,a,e),void F[f.key][d?"unshift":"push"]({callback:b,modifiers:f.modifiers,action:f.action,seq:d,level:e,combo:a}))}function w(a,b,c){N(a,function(a){v(a,b,c)})}for(var x,y,z,A=document,B={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},C={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},D={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},E={option:"alt",command:"meta","return":"enter",escape:"esc",mod:b.isApple},F={},G={},H={},I=!1,J=!1,K=!1,L=a.lc,M=a.indexOf,N=a.each,O=1;20>O;++O)B[111+O]="f"+O;for(O=0;9>=O;++O)B[O+96]=O;return N(["keypress","keydown","keyup"],function(a){d.on(A,a,o)}),x={on:function(b,c,d){return b=a.isArray(b)?b:[b],w(b,c,d),this},off:function(a,b){return x.on(a,function(){},b)},trigger:function(a,b){return G[a+":"+b]&&G[a+":"+b]({},a),this},reset:function(){return F={},G={},this},stop:function(a,b){if(c.contains(b,"js-hotkey"))return!1;var d=b.tagName;return M(["INPUT","SELECT","TEXTAREA"],d)>-1||b.isContentEditable},handleKey:n}}),define("pastry/url/querystring",["pastry/pastry"],function(a){"use strict";var b=encodeURIComponent,c=function(a){return decodeURIComponent(a.replace(/\+/g," "))},d={escape:b,unescape:c,parse:function(b,d,e){d=d||"&",e=e||"=";var f,g={},h=b.split(d);return a.each(h,function(a){f=a.split(e),f.length>0&&(g[c(f.shift())]=c(f.join(e)))}),g},stringify:function(c,d){var e=[],f=d&&d.arrayKey?!0:!1;return a.each(c,function(c,d){a.isArray(c)?a.each(c,function(a){e.push(b(f?d+"[]":d)+"="+b(a))}):e.push(b(d)+"="+b(c))}),e.join("&")}};return d}),define("pastry/io/ajax",["pastry/pastry","pastry/bom/utils","pastry/encoding/json","pastry/url/querystring"],function(a,b,c,d){"use strict";function e(){return a.getAny(function(){return new XMLHttpRequest},function(){return new ActiveXObject("MSXML2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})}var f=0,g=a.hasSubString,h=function(h,i){i=i||{};var j=e(),k=i.method?a.uc(i.method):"GET",l=i.type?a.lc(i.type):"xml",m=i.data?d.stringify(i.data):null,n=i.contentType,o=!0,p=i.username,q=i.password;a.each(["abort","error","load","loadend","loadstart","progress","success","timeout"],function(a){i[a]&&(j["on"+a]=i[a])}),j.isSuccess=function(){var a=j.status;return a>=200&&300>a||304===a||!a&&"file:"===location.protocol||!a&&b.versions.safari},j.onreadystatechange=function(){if(4===j.readyState)if(j.isSuccess()){if(i.success){var b=j.responseText;"json"===l&&(b=a.getAny(function(){return c.parse(b)})||b),j.onsuccess(b)}}else i.error&&j.onerror(j.statusText)},"GET"===k?(i.noCache&&(h+=(g(h,"?")?"&":"?")+"_PASTRY_NO_CACHE_="+f++),m&&(h+=(g(h,"?")?"&":"?")+m),j.open(k,h,o,p,q),j.setRequestHeader("Content-Type",n||"text/plain;charset=UTF-8")):"POST"===k?(j.open(k,h,o,p,q),j.setRequestHeader("Content-Type",n||"application/x-www-form-urlencoded;charset=UTF-8")):j.open(k,h,o,p,q),j.send(m)};return a.ajax=h}),define("pastry/promise/Promise",["pastry/pastry","pastry/oop/declare"],function(a,b){"use strict";function c(b){return a.Promise=b,a.setGLOBAL("Promise",b),b}function d(a){var b=this;if(!h(a))throw"Promise resolver "+a+" is not a function";var c=b._resolver=new j;try{a(function(a){c.resolve(a)},function(a){c.reject(a)})}catch(d){c.reject(d)}}if("undefined"!=typeof Promise&&Promise&&Promise.resolve)return c(Promise);var e=a.extend,f=a.each,g=a.isArray,h=a.isFunction,i=a.isObject,j=b("pastry/promise/Resolver",[],{constructor:function(){e(this,{_callbacks:[],_errbacks:[],_status:"pending",_result:null})},fulfill:function(a){var b=this,c=b._status;("pending"===c||"accepted"===c)&&(b._result=a,b._status="fulfilled"),"fulfilled"===b._status&&(b._notify(b._callbacks,b._result),b._callbacks=[],b._errbacks=null)},reject:function(a){var b=this,c=b._status;("pending"===c||"accepted"===c)&&(b._result=a,b._status="rejected"),"rejected"===b._status&&(b._notify(b._errbacks,b._result),b._callbacks=null,b._errbacks=[])},resolve:function(a){var b=this;"pending"===b._status&&(b._status="accepted",b._value=a,(b._callbacks&&b._callbacks.length||b._errbacks&&b._errbacks.length)&&b._unwrap(b._value))},_unwrap:function(a){var b,c=this,d=!1;if(!a||!i(a)&&!h(a))return void c.fulfill(a);try{b=a.then,h(b)?b.call(a,function(a){d||(d=!0,c._unwrap(a))},function(a){d||(d=!0,c.reject(a))}):c.fulfill(a)}catch(e){d||c.reject(e)}},_addCallbacks:function(a,b){var c=this,d=c._callbacks,e=c._errbacks;switch(d&&d.push(a),e&&e.push(b),c._status){case"accepted":c._unwrap(c._value);break;case"fulfilled":c.fulfill(c._result);break;case"rejected":c.reject(c._result)}},_notify:function(a,b){a.length&&d.async(function(){f(a,function(a){a(b)})})}});return a.extend(d,{Resolver:j,resolve:function(a){return a&&a.constructor===this?a:new this(function(b){b(a)})},reject:function(a){var b=new this(function(){});return b._resolver._result=a,b._resolver._status="rejected",b},all:function(a){return new d(function(b,c){function e(a){return function(c){j[a]=c,f--,f||b(j)}}if(!g(a))return void c(new Error("Promise.all expects an array of values or promises"));var f=a.length,h=0,i=a.length,j=[];if(1>i)return b(j);for(;i>h;h++)d.resolve(a[h]).then(e(h),c)})},race:function(a){return new d(function(b,c){return g(a)?void f(a,function(a){d.resolve(a).then(b,c)}):void c(new Error("Promise.race expects an array of values or promises"))})},async:a.getAny(function(){return setImmediate?function(a){setImmediate(a)}:void 0},function(){return process.nextTick},function(){return function(a){setTimeout(a,0)}}),_makeCallback:function(a,b,c,d){return function(e){var f;try{f=d(e)}catch(g){return void c(g)}return f===a?void c(new Error("Cannot resolve a promise with itself")):void b(f)}}}),c(b("pastry/promise/Promise",[],{constructor:d,then:function(a,b){var c,e,f=new d(function(a,b){c=a,e=b});return this._resolver._addCallbacks(h(a)?d._makeCallback(f,c,e,a):c,h(b)?d._makeCallback(f,c,e,b):e),f},"catch":function(a){return this.then(void 0,a)}}))}),define("pastry/io/fetch",["pastry/pastry","pastry/io/ajax","pastry/promise/Promise"],function(a,b,c){"use strict";function d(b){return a.setGLOBAL("fetch",b),b}var e=a.isFunction;return d("undefined"!=typeof fetch&&fetch&&e(fetch)?fetch:function(d,f){return new c(function(c,g){var h=f.success,i=f.error;b(d,a.extend({},f,{success:function(a){e(h)&&h(a),c(a)},error:function(a){e(i)&&i(a),g(a)}}))})})}),define("pastry/dom/construct",["pastry/pastry","pastry/bom/utils","pastry/dom/query"],function(a,b,c){"use strict";function d(a,b){var c=b.parentNode;c&&c.insertBefore(a,b)}function e(a,b){var c=b.parentNode;c&&(c.lastChild===b?c.appendChild(a):c.insertBefore(a,b.nextSibling))}var f,g=window,h=document||g.document,i=c.one,j={option:["select"],tbody:["table"],thead:["table"],tfoot:["table"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","thead","tr"],legend:["fieldset"],caption:["table"],colgroup:["table"],col:["table","colgroup"],li:["ul"]},k=/<\s*([\w\:]+)/,l=h.createElement("div");return a.each(j,function(a,b){a.pre="option"===b?'<select multiple="multiple">':"<"+a.join("><")+">",a.post="</"+a.reverse().join("></")+">"}),f={toDom:function(b){b+="";var c,d,e,f,g=b.match(k),i=g?a.lc(g[1]):"",m=l;if(g&&j[i])for(c=j[i],m.innerHTML=c.pre+b+c.post,d=c.length;d;--d)m=m.firstChild;else m.innerHTML=b;if(1===m.childNodes.length)return m.removeChild(m.firstChild);for(f=h.createDocumentFragment();e=m.firstChild;)f.appendChild(e);return f},place:function(b,c,g){if(c=i(c),a.isString(b)&&(b=/^\s*</.test(b)?f.toDom(b,c.ownerDocument):i(b)),a.isNumber(g)){var h=c.childNodes;!h.length||h.length<=g?c.appendChild(b):d(b,h[0>g?0:g])}else switch(g){case"before":d(b,c);break;case"after":e(b,c);break;case"replace":c.parentNode.replaceChild(b,c);break;case"only":f.empty(c),c.appendChild(b);break;case"first":c.firstChild?d(b,c.firstChild):c.appendChild(b);break;default:c.appendChild(b)}},create:function(b,c,d){return c&&(c=i(c),h=c.ownerDocument),a.isString(b)&&(b=h.createElement(b)),c&&f.place(b,c,d),b},empty:function(a){if(a=i(a),"innerHTML"in a)try{return void(a.innerHTML="")}catch(b){}for(var c;c=a.lastChild;)a.removeChild(c)},destroy:function(a){if(a=i(a)){var c=a.parentNode;a.firstChild&&f.empty(a),c&&(b.isIE&&c.canHaveChildren&&"removeNode"in a?a.removeNode(!1):c.removeChild(a))}}}}),define("pastry/dom/data",["pastry/dom/query","pastry/dom/utils"],function(a,b){"use strict";var c,d="dataset",e="data-",f=b.hasDataSet;return c={get:function(b,c){return b=a.one(b),f?b[d][c]:b[e+c]},set:function(b,c,g){b=a.one(b),f?b[d][c]=g:b[e+c]=g}}}),define("pastry/dom/style",["pastry/pastry","pastry/bom/utils","pastry/dom/data","pastry/dom/query","pastry/dom/utils"],function(a,b,c,d,e){"use strict";function f(a,b){try{return a.filters.item(s)}catch(c){return b?{}:null}}function g(a){return"none"===l.get(a,"display")||e.contains(a.ownerDocument,a)}function h(b,d){var e,f,h=[];return a.each(b,function(a,b){a.style&&(h[b]=c.get(a,"olddisplay"),e=a.style.display,d?(h[b]||"none"!==e||(a.style.display=""),""===a.style.display&&g(a)&&(h[b]=c.set(a,"olddisplay",l.get(a,"display")))):(f=g(a),"none"===e&&f||c.set(a,"olddisplay",f?e:l.get(a,"display"))))}),a.each(b,function(a,b){a.style&&(d&&"none"!==a.style.display&&""!==a.style.display||(a.style.display=d?h[b]||"":"none"))}),b}function i(b,c,d){if(c=a.lc(c),q||p.trident){if("auto"===d){if("height"===c)return b.offsetHeight;if("width"===c)return b.offsetWidth}if("fontweight"===c)switch(d){case 700:return"bold";default:return"normal"}}return c in u||(u[c]=t.test(c)),u[c]?k(b,d):d}var j,k,l,m,n,o=d.one,p=b.versions,q=p.msie||0,r=e.isQuirks,s="DXImageTransform.Microsoft.Alpha",t=/margin|padding|width|height|max|min|offset/,u={left:!0,top:!0},v={cssFloat:1,styleFloat:1,"float":1};return q&&(9>q||10>q&&r)?(m=function(a){try{return f(a).Opacity/100}catch(b){return 1}},n=function(a,b){""===b&&(b=1);var c=100*b,d=1===b;if(d?(a.style.zoom="",f(a)&&(a.style.filter=a.style.filter.replace(new RegExp("\\s*progid:"+s+"\\([^\\)]+?\\)","i"),""))):(a.style.zoom=1,f(a)?f(a,1).Opacity=c:a.style.filter+=" progid:"+s+"(Opacity="+c+")",f(a,1).Enabled=!0),"tr"===a.tagName.toLowerCase())for(var e=a.firstChild;e;e=e.nextSibling)"td"===e.tagName.toLowerCase()&&n(e,b);return b}):(m=function(a){return j(a).opacity},n=function(a,b){return a.style.opacity=b}),j=b.isWebkit?function(a){var b;if(1===a.nodeType){var c,d=a.ownerDocument.defaultView;b=d.getComputedStyle(a,null),!b&&a.style&&(c=a.style.display,a.style.display="",b=d.getComputedStyle(a,null)),a.style.display=c}return b||{}}:q&&9>q||r?function(a){return 1===a.nodeType&&a.currentStyle?a.currentStyle:{}}:function(a){return 1===a.nodeType?a.ownerDocument.defaultView.getComputedStyle(a,null):{}},k=q?function(a,b){if(!b)return 0;if("medium"===b)return 4;if(b.slice&&"px"===b.slice(-2))return parseFloat(b);var c=a.style,d=a.runtimeStyle,e=a.currentStyle,f=c.left,g=d.left;d.left=e.left;try{c.left=b,b=c.pixelLeft}catch(h){b=0}return c.left=f,d.left=g,b}:function(a,b){return parseFloat(b)||0},l={getComputedStyle:j,toPixel:k,get:function(a,b){var c,d=o(a),e=arguments.length,f="opacity"===b;return 2===e&&f?m(d):(b=v[b]?"cssFloat"in d.style?"cssFloat":"styleFloat":b,c=l.getComputedStyle(d),1===e?c:i(d,b,c[b]||d.style[b]))},set:function(a,b,c){var d=o(a),e=arguments.length,f="opacity"===b;if(b=v[b]?"cssFloat"in d.style?"cssFloat":"styleFloat":b,3===e)return f?n(d,c):d.style[b]=c;for(var g in b)l.set(a,g,b[g]);return l.getComputedStyle(d)},show:function(a){h(d.all(a),!0)},hide:function(a){h(d.all(a),!1)},toggle:function(a){return"none"===l.get(a,"display")?l.show(a):l.hide(a)}}}),define("pastry/ui/Component",["pastry/pastry","pastry/oop/declare","pastry/dom/construct","pastry/dom/query","pastry/dom/style"],function(a,b,c,d,e){"use strict";var f=document.body,g=a.extend,h=a.destroy,i=b("pastry-Component",[],{initialise:function(a){var b=this;return g(b,{domNode:null},a),b},destroy:function(){var a=this;return c.destroy(a.domNode),h(a),a},placeAt:function(a,b){var e,g=this;return a=d.one(a)||f,(e=g.domNode)&&c.place(e,a,b),g},show:function(){var a,b=this;return(a=b.domNode)&&e.show(a),b},hide:function(){var a,b=this;return(a=b.domNode)&&e.hide(a),b}});return i}),define("pastry/template/collapse",["pastry/pastry","pastry/html/escape"],function(helper){return function(obj,ne){var _e=ne?function(a){return a}:helper.escape;with(obj=obj||{})_s='<div class="panel-group" id="'+_e(id)+'"></div>';return _s}}),define("pastry/template/collapseSection",["pastry/pastry","pastry/html/escape"],function(helper){return function(obj,ne){var _e=ne?function(a){return a}:helper.escape;with(obj=obj||{})_s='<div class="panel panel-default"><div class="panel-heading"><h4 class="panel-title"><a data-toggle="collapse">'+_e(head)+'</a></h4></div><div class="panel-collapse collapse"><div class="panel-body">'+_e(body)+"</div></div></div>";return _s}}),define("pastry/ui/Collapse",["pastry/pastry","pastry/oop/declare","pastry/ui/Component","pastry/dom/class","pastry/dom/construct","pastry/dom/event","pastry/dom/query","pastry/dom/utils","pastry/template/collapse","pastry/template/collapseSection"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(a,b){r(a)&&a.call(null,b)}var l="p_u_collapse",m="p_u_collapse_section",n=a.each,o=a.extend,p=a.isArray,q=h.isString,r=a.isFunction,s=a.isString,t=a.uuid,u=b("pastry/ui/CollapseSection",[c],{constructor:function(a){var b=this;return o(b,{isOpen:!1},a),f.on(b.head,"click",function(){b._onClick()}),b.isOpen?b.open():b.close()},_onClick:function(){var a=this;return k(a.onClick,a),a},open:function(){var a=this;return a.isOpen=!0,d.add(a.body,"in"),a},close:function(){var a=this;return a.isOpen=!1,d.remove(a.body,"in"),a},toggle:function(){var a=this;return d.toggle(a.body,"in"),a},destroy:function(){var a=this;return e.destroy(a.head),e.destroy(a.body),c.prototype.destroy.call(a),a}}),v=b("pastry/ui/Collapse",[c],{constructor:function(a,b){var c=this;return b=b||{},q(a)?b.domNode=a:b=a,o(c,{isAccordion:!0,_sections:{}},b),c.id=c.id||t(l),c.domNode?c.id=c.domNode.id||c.id:c.domNode=e.toDom(i(c)),n(g.all(".panel",c.domNode),function(a){c.addSection(a)}),p(c.sections)&&n(c.sections,function(a){c.addSection(a)}),c},eachSection:function(a){var b=this;return n(b._sections,function(b){k(a,b)}),b},addSection:function(a){var b,c,d,f,i=this;return a instanceof u?(i._sections[a.id]=a,i):(q(a)||s(a)?(b=g.one(a),a={domNode:b}):a.head&&s(a.head)?(b=e.toDom(j(a)),o(a,{domNode:b})):a.domNode&&(b=a.domNode),a.id||(a.id=b.id||t(m)),c=a.id,o(a,{head:g.one(".panel-title [data-toggle=collapse]",b),body:g.one(".panel-collapse.collapse",b)}),f=a.onClick,a.onClick=function(a){k(f,a),i.toggleSection(a.id)},d=new u(a),i._sections[c]=d,h.contains(d.domNode,i.domNode)||d.placeAt(i.domNode),i)},removeSection:function(a){var b=this;return b._sections[a].destroy(),delete b._sections[a],b},openSection:function(a){var b=this,c=b._sections[a];return b.isAccordion&&b.eachSection(function(a){a.close()}),c.open(),b},closeSection:function(a){var b=this;return b._sections[a].close(),b},toggleSection:function(a){var b=this,c=b._sections[a];return c.isOpen?b.closeSection(a):b.openSection(a)},destroy:function(){var a=this;a.eachSection(function(a){a.destroy()}),c.prototype.destroy.call(a),a=null}});return v.Section=u,v.render=function(a,b){return a=g.one(a),new v(a,b)},v}),define("pastry/template/notify",["pastry/pastry","pastry/html/escape"],function(helper){return function(obj,ne){var _e=ne?function(a){return a}:helper.escape;with(obj=obj||{})_s='<div class="notify-wrapper" id="'+_e(id)+'"></div>';return _s}}),define("pastry/template/notifyMessage",["pastry/pastry","pastry/html/escape"],function(helper){return function(obj,ne){var _e=ne?function(a){return a}:helper.escape;with(obj=obj||{})_s='<div class="notify-message notify-message-'+_e(type)+'" id="'+_e(id)+'"><div class="notify-message-inner"><div class="notify-icon notify-icon-'+_e(type)+'">',"info"===type&&(_s+='<span class="icon icon-info-o"></span>'),_s+="","error"===type&&(_s+='<span class="icon icon-close-o"></span>'),_s+="","warning"===type&&(_s+='<span class="icon icon-warning-o"></span>'),_s+="","success"===type&&(_s+='<span class="icon icon-ok-o"></span>'),_s+='</div><div class="notify-text"> '+_e(text)+" </div></div></div>";return _s}}),define("pastry/ui/Notify",["pastry/pastry","pastry/oop/declare","pastry/ui/Component","pastry/dom/construct","pastry/dom/event","pastry/template/notify","pastry/template/notifyMessage"],function(a,b,c,d,e,f,g){"use strict";var h="p_u_notify",i="p_u_notify_message",j={type:"info",text:"message",maxCount:10,lifetime:5e3},k=a.extend,l=a.isFunction,m=a.uuid,n=b("Notify",[c],{constructor:function(a){var b=this;return a=a||{},k(b,{id:m(h),message:{},messageCount:0,messageQueue:[],status:{},option:j},a),a.domNode=a.domNode||d.toDom(f({id:b.id})),b.initialise(a),b.placeAt(),b},_initMessage:function(a){var b=this,c=k({},a,{domNode:d.toDom(g(a))});return e.on(c.domNode,"click",function(){b._hideById(c.id)}),c},_showById:function(a){var b=this,c=b.message[a];return c&&(d.place(c.domNode,b.domNode,"first"),b.messageCount++,l(c.onShow)&&c.onShow(),c.timeout=setTimeout(function(){b.message[c.id]&&b._hideById(c.id)},c.lifetime?c.lifetime:b.option.lifetime)),b},_hideById:function(a){var b=this,e=b.message[a];return e&&(d.destroy(e.domNode),b.messageCount--,clearTimeout(e.timeout),b._showNext(),l(e.onHide)&&e.onHide(),c.prototype.destroy.apply(e),delete b.message[a]),b},_showNext:function(){var a=this,b=a.messageQueue.pop();return b&&a._showById(b),a},config:function(a){var b=this;return k(b.option,a),b},log:function(a){var b,c=this,d=a.id||m(i);a=k({id:d},c.option,a),c.message[d]=b=c._initMessage(a),c.messageCount>=c.option.maxCount?c.messageQueue.push(d):c._showById(d)}});return n}),define("pastry/template/tooltip",["pastry/pastry","pastry/html/escape"],function(helper){return function(obj,ne){var _e=ne?function(a){return a}:helper.escape;with(obj=obj||{})_s='<div class="tooltip" id="'+_e(id)+'"><div class="tooltip-arrow"></div><div class="tooltip-body"></div></div>';return _s}}),define("pastry/ui/Tooltip",["pastry/pastry","pastry/oop/declare","pastry/ui/Component","pastry/dom/class","pastry/dom/construct","pastry/dom/query","pastry/dom/style","pastry/template/tooltip"],function(a,b,c,d,e,f,g,h){"use strict";var i="p_u_tooltip",j=document.body,k=a.each,l=a.extend,m=b("Tooltip",[c],{constructor:function(b){b=b||{};var c,d=this;return d.option=l({gravity:"n",html:!1,offset:6},b),d.id=b.id||a.uuid(i),c=d.domNode=e.toDom(h(d)),d.placeAt(j),d.wrapArrow=f.one(".tooltip-arrow",c),d.wrapBody=f.one(".tooltip-body",c),d.hide(),d.isShown=!1,d},show:function(a,b,f){var h,i,m,n=this,o=n.domNode,p=n.wrapArrow,q=n.wrapBody,r=l({},n.option,f),s=r.gravity;if(a&&""!==a&&(q.innerHTML="",r.html?(h=e.toDom(a),e.place(h,q,"only")):q.innerHTML=a),d.clear(p),d.add(p,"tooltip-arrow tooltip-arrow-"+s.charAt(0)),d.clear(o),d.add(o,"tooltip tooltip-"+s),r.className&&d.add(o,"tooltip-"+r.className),c.prototype.show.call(n),n.isShown=!0,i=l({},b.getBoundingClientRect(),{width:b.offsetWidth,height:b.offsetHeight}),"object"==typeof b.nearestViewportElement){var t=b.getBoundingClientRect();i.width=t.width,i.height=t.height}switch(m={width:q.offsetWidth,height:q.offsetHeight},r.offset=r.offset||0,s.charAt(0)){case"n":m={top:i.top+i.height+r.offset,left:i.left+i.width/2-m.width/2};break;case"s":m={top:i.top-m.height-r.offset,left:i.left+i.width/2-m.width/2};break;case"e":m={top:i.top+i.height/2-m.height/2,left:i.left-m.width-r.offset};break;case"w":m={top:i.top+i.height/2-m.height/2,left:i.left+i.width+r.offset}}return m.top+=j.scrollTop,m.left+=j.scrollLeft,2===s.length&&(m.left="w"===s.charAt(1)?i.left+i.width/2-15:i.left+i.width/2-m.width+15),k(m,function(a,b){g.set(o,b,a+"px")}),n},hide:function(){var a=this;return a.isShown=!1,c.prototype.hide.call(a)}});return m}),define("pastry/dom/attr",["pastry/pastry","pastry/bom/utils","pastry/dom/utils","pastry/dom/query","pastry/dom/construct","pastry/dom/style"],function(a,b,c,d,e,f){"use strict";function g(a,b){var c=a.getAttributeNode&&a.getAttributeNode(b);return!!c&&c.specified}function h(a){for(var b,c="",d=a.childNodes,e=0;b=d[e];e++)8!==b.nodeType&&(c+=1===b.nodeType?h(b):b.nodeValue);return c}function i(a,b){var c=b.toLowerCase(),d=exports.names[c]||b;return"textContent"!==d||r?a[d]:h(a)}function j(a,b,c){var d=arguments.length;if(2===d&&!q(b)){for(var g in b)j(a,g,b[g]);return a}var h=n(b),i=t[h]||b;return"style"!==i||q(c)?"innerHTML"===i?(m&&n(a.tagName)in{col:1,colgroup:1,table:1,tbody:1,tfoot:1,thead:1,tr:1,title:1}?(e.empty(a),a.appendChild(e.toDom(c,a.ownerDocument))):a[i]=c,a):"textContent"!==i||r?(a[i]=c,a):(e.empty(a),a.appendChild(a.ownerDocument.createTextNode(c)),a):(f.set(a,c),a)}var k,l=b.versions,m=l.msie||0,n=a.lc,o=a.isBoolean,p=a.isFunction,q=a.isString,r=c.hasTextContent,s=d.one,t={"class":"className","for":"htmlFor",tabindex:"tabIndex",readonly:"readOnly",colspan:"colSpan",frameborder:"frameBorder",rowspan:"rowSpan",textcontent:"textContent",valuetype:"valueType"},u={innerHTML:1,textContent:1,className:1,htmlFor:!!m,value:1},v={classname:"class",htmlfor:"for",tabindex:"tabIndex",readonly:"readOnly"};return k={has:function(a,b){var c=n(b);return u[t[c]||b]||g(s(a),v[c]||b)},get:function(b,c){b=s(b);var d,e=n(c),f=t[e]||c,h=u[f],j=b[f];return h&&!a.isUndefined(j)?j:"textContent"===f?i(b,f):"href"!==f&&(o(j)||p(j))?j:(d=v[e]||c,g(b,d)?b.getAttribute(d):null)},set:function(a,b,c){if(a=s(a),2===arguments.length){for(var d in b)k.set(a,d,b[d]);return a}var e=b.toLowerCase(),g=t[e]||b,h=u[g];return"style"===g&&q(c)?(f.set(a,c),a):h||o(c)||p(c)?j(a,b,c):(a.setAttribute(v[e]||b,c),a)},remove:function(a,b){s(a).removeAttribute(v[n(b)]||b)},getNodeProp:function(a,b){a=s(a);var c,d=n(b),e=t[d]||b;return e in a&&"href"!==e?a[e]:(c=v[d]||b,g(a,c)?a.getAttribute(c):null)}}}),define("pastry/template/tree",["pastry/pastry","pastry/html/escape"],function(helper){return function(obj,ne){var _e=ne?function(a){return a}:helper.escape;with(obj=obj||{})_s='<table class="tree-wrapper table table-hover" id="'+_e(id)+'">',hasHead&&(_s+="<thead><tr><th>"+_e(treeColumnName)+"</th>",helper.each(extraColumns,function(a){_s+="<th>"+_e(a.label)+"</th>"}),_s+="</tr></thead>"),_s+="<tbody></tbody></table>";return _s}}),define("pastry/template/treeNode",["pastry/pastry","pastry/html/escape"],function(helper){return function(obj,ne){var _e=ne?function(a){return a}:helper.escape;with(obj=obj||{})_s='<tr data-id="'+_e(id)+'" class="tree-node ',isSelected&&(_s+="selected"),_s+='" ',isDraggable&&(_s+=' draggable="true" '),_s+=" ",isDroppable&&(_s+=' droppable="true" '),_s+='><td><span class="tree-node-indenter" style="margin-left: '+_e(indent)+'px;">',isBranch&&(_s+="",_s+=hasExpanderIcon?'<span class="tree-node-expander '+_e(expanderIconClass)+'" data-id="'+_e(id)+'"></span>':'<span class="tree-node-expander" data-id="'+_e(id)+'">'+_e(expanderText)+"</span>",_s+=""),_s+="</span>",hasCheckbox&&(_s+='<label class="tree-node-checkbox checkbox-inline"><input type="checkbox" value="'+_e(id)+'"></label>'),_s+="",hasIcon&&(_s+='<span class="tree-node-icon '+_e(iconClass)+'"></span>'),_s+='<span class="tree-node-label" ',title&&(_s+=' title="'+_e(title)+'" '),_s+=">"+_e(label)+"</span></td>",extraColumns&&(_s+="",helper.each(extraColumns,function(a){_s+="<td>"+_e(obj[a.key])+"</td>"}),_s+=""),_s+="</tr>";return _s}}),define("pastry/ui/Tree",["pastry/pastry","pastry/oop/declare","pastry/bom/utils","pastry/dom/attr","pastry/dom/class","pastry/dom/construct","pastry/dom/data","pastry/dom/event","pastry/dom/query","pastry/dom/style","pastry/dom/utils","pastry/ui/Component","pastry/template/tree","pastry/template/treeNode"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";function o(a,b){return G(b,function(b,c){return a[c]===b})}function p(a){return a.ctrlKey||a.metaKey||a.shiftKey}function q(a){F(a,function(a){a.isDroppable&&d.remove(a.domNode,"droppable"),q(a.children)})}function r(a){F(a,function(a){a.isDroppable&&d.set(a.domNode,"droppable","true"),r(a.children)})}var s="p_u_tree",t="p_u_tree_node",u=16,v="selected",w=".tree-node",x="fa fa-folder",y="fa fa-folder-open",z="fa fa-file",A="fa fa-plus-square-o",B="fa fa-minus-square-o",C="&blacktriangleright;",D="&blacktriangledown;",E=a.difference,F=a.each,G=a.every,H=a.extend,I=a.hasKey,J=a.indexOf,K=a.isArray,L=h.on,M=a.remove,N=a.uuid,O=b("pastry/ui/tree/Node",[l],{constructor:function(a){if(a instanceof O)return a;var b=this;return H(b,{isRoot:!1,isBranch:!1,isLeaf:!0,isExpanded:!0,isExpandable:!1,isSelected:!1,isChecked:!1,isFocused:!1,isLoaded:!1,isDraggable:!1,isDroppable:!1,domNode:null,indenterElement:null,expanderElement:null,labelElement:null,iconElement:null,children:[],parent:null},a),F(["canDnD","hasIcon","hasExpanderIcon","hasCheckbox"],function(a){I(b,a)||(b[a]=b.tree[a]||!1)}),b},id:null,label:null,title:null,indent:0,parentId:null,iconClass:null,expanderIconClass:null,expanderText:null,_setLabel:function(){var a,b=this;return a=b.tree.getLabel?b.tree.getLabel(b):b.label||b.name||"",b.label=a,b.labelElement&&(b.labelElement.innerHTML=a),b},_setTitle:function(){var a=this;return a.tree.getTitle&&(a.title=a.tree.getTitle(a)),a},_setIconClass:function(){var a,b=this;return b.hasIcon&&(a=b.tree.getIconClass?b.tree.getIconClass(b):b.isBranch?b.isExpanded?y:x:z,b.iconClass=a,b.iconElement&&(e.clear(b.iconElement),e.add(b.iconElement,"tree-node-icon "+a))),b},_setSelectedClass:function(){var a=this,b=a.domNode;return b&&e[a.isSelected?"add":"remove"](b,v),a},_setDnD:function(){var a=this,b=a.tree;return a.canDnD&&(a.isDraggable=b.getDraggable?b.getDraggable(a):!0,a.isDroppable=b.getDroppable?b.getDroppable(a):a.isBranch),a},_setExpanderIconClass:function(){var a,b=this;return b.isExpandable&&b.hasExpanderIcon&&(a=b.tree.getExpanderIconClass?b.tree.getExpanderIconClass(b):b.isExpanded?B:A,b.expanderIconClass=a,b.expanderElement&&(e.clear(b.expanderElement),e.add(b.expanderElement,"tree-node-expander "+a))),b},_setExpanderText:function(){var a,b=this;return b.isExpandable&&!b.hasExpanderIcon&&(a=b.tree.getExpanderText?b.tree.getExpanderText(b):b.isExpanded?D:C,b.expanderText=a,b.expanderElement&&(b.expanderElement.innerHTML=a)),b},_setIndent:function(){var a,b=this;return a=u*b.getLevel(),b.indent=a,b.indenterElement&&j.set(b.indenterElement,"margin-left",a+"px"),b},_setLoaded:function(){var a=this;a.isLoaded=!0,a.eachChild(function(a){a.load()})},_setSelected:function(a){var b=this,c=b.tree;return a||(F(c.selectedNodes,function(a){a.isSelected=!1,a._updateLayout()}),c.selectedNodes=[]),b.isSelected=!0,c.selectedNode=b,c.selectedNodes.push(b),b._updateLayout()},_reload:function(){var a=this;a.eachChild(function(a){a.reload()})},_updateLayout:function(){return this._setLabel()._setTitle()._setIconClass()._setSelectedClass()._setExpanderIconClass()._setExpanderText()._setIndent()},_canMoveTo:function(a){var b=this;return a.id===b.id||a.isLeaf||J(b.children,a)>-1||b.parent===a||J(a.getAncestors(),b)>-1?!1:!0},_isAncestorsExpanded:function(){return G(this.getAncestors(),function(a){return a.isExpanded})},addChild:function(a){var b=this;return-1===J(b.children,a)&&b.children.push(a),a.isRoot=!1,a.parentId=b.id,a.parent=b,a.isLoaded&&(a.reload(),a._isAncestorsExpanded()?a.show():a.hide()),b},removeChild:function(a){var b,c=this;return-1!==(b=J(c.children,a))&&(M(c.children,b),a.isLoaded&&c.isExpanded&&a.hide()),c},moveTo:function(a){var b=this,c=b.tree,d=c.beforeMove,e=c.onMove;return b._canMoveTo(a)&&d(b,a,function(){b.parent&&b.parent.removeChild(b),a.addChild(b),e(b,a)}),b},eachChild:function(a){var b=this;return F(b.children,function(b){a(b)}),b},getParent:function(){var a=this,b=a.parentId;return a.parent?a.parent:"undefined"!=typeof b?a.tree.nodeById[b]:null},getAncestors:function(){for(var a=this,b=[];a=a.getParent();)b.push(a);return b},getLevel:function(){return this.getAncestors().length},select:function(a){return this._setSelected(a)},show:function(){var a=this;return l.prototype.show.apply(a),a.isExpanded&&a.eachChild(function(a){a.show()}),a},hide:function(){var a=this;return l.prototype.hide.apply(a),a.isExpanded&&a.eachChild(function(a){a.hide()}),a},expand:function(){var a=this;return a.isExpanded=!0,a.eachChild(function(a){a.show()}),a._updateLayout(),a.tree.onExpand(a),a},collapse:function(){var a=this;return a.isExpanded=!1,a.eachChild(function(a){a.hide()}),a._updateLayout()},toggle:function(){var a=this;return a.isExpanded?a.collapse():a.expand()},render:function(){var a,b=this;return b.parent||(b.isRoot=!0),b.children.length&&(b.isBranch=!0,b.isLeaf=!1),b.isBranch&&(b.isLeaf=!1),b.isExpandable=b.isBranch,b._setDnD(),a=b.domNode=b.domNode||f.toDom(n(b,!0)),b.indenterElement=b.indenterElement||i.one(".tree-node-indenter",a),b.expanderElement=b.expanderElement||i.one(".tree-node-expander",a),b.labelElement=b.labelElement||i.one(".tree-node-label",a),b.iconElement=b.iconElement||i.one(".tree-node-icon",a),b._updateLayout(),b._isAncestorsExpanded()||b.hide(),b},load:function(){var a=this;return a.isLoaded||(a.isRoot?(a.placeAt(a.tree.bodyElement,"first"),a._setLoaded()):a.parent.isLoaded&&(a.placeAt(a.parent.domNode,"after"),a._setLoaded())),a},reload:function(){var a=this;return a.isLoaded?(a._updateLayout(),a.isRoot?(a.placeAt(a.tree.bodyElement,"first"),a._reload()):a.parent.isLoaded&&(a.placeAt(a.parent.domNode,"after"),a._reload())):a.load(),a},update:function(a){return H(this,a).render()}}),P=function(a,b){return b.nodeById[g.get(a.delegateTarget,"id")]},Q=b("pastry/ui/Tree",[l],{constructor:function(a){a=a||{};var b,d=this;H(d,{id:N(s),data:[],nodes:[],nodeById:{},domNode:null,headElement:null,bodyElement:null,selectedNodes:[]},a),a.domNode&&(d.domNode=i.one(a.domNode)),d.domNode||(d.domNode=f.toDom(m(d))),b=d.domNode,d.hasHead&&(d.headElement=i.one("thead",b)),d.bodyElement=i.one("tbody",b),d.addNodes(d.data),delete d.data,L(b,"click",".tree-node-expander",function(a){P(a,d).toggle()}),L(b,"click",w,function(a){var b=P(a,d);d.onClick(b),b.select(p(a)),d.onSelect(b)}),L(b,"contextmenu",w,function(a){var b=P(a,d);a.preventDefault(),d.onContextmenu(b,a)}),L(b,"dblclick",w,function(a){var b=P(a,d);d.onDblclick(b)});var g="dragover",h=w+'[droppable="true"]';return!c.isOpera&&k.canDnD?(L(b,"dragstart",w,function(a){var b=P(a,d);-1===J(d.selectedNodes,b)&&b.select(),a.dataTransfer.effectAllowed="copy",a.dataTransfer.setData("id",b.id),q(d.selectedNodes)}),L(b,"dragend",w,function(){r(d.selectedNodes);var a=i.one("."+g,b);a&&e.remove(a,g)}),L(b,"dragover",h,function(a){var b=P(a,d);return e.add(b.domNode,g),a.preventDefault(),!1}),L(b,"dragleave",h,function(a){var b=P(a,d);e.remove(b.domNode,g)}),L(b,"drop",h,function(a){var b=P(a,d);return a.stopPropagation&&a.stopPropagation(),F(d.selectedNodes,function(a){a.moveTo(b)}),!1})):console.warn("drag and drop feature not supported"),d},canDnD:!1,extraColumns:[],hasCheckbox:!1,hasExpanderIcon:!1,hasHead:!1,hasIcon:!1,treeColumnName:"tree",_processData:function(a){var b=this;return F(a,function(a){var c=a.id;H(a,{extraColumns:b.extraColumns,tree:b}),"undefined"==typeof a.id&&(c=a.id=N(t)),b.nodeById[c]||(b.nodeById[a.id]=a)}),b},_processNodes:function(a){var b,c,d=this;return F(a,function(a){if(c=a.getParent(),null!==a.parentId){if(!c)throw"node with id "+b+" does not exists";a.parent=c,c.addChild(a)}}),d},addNodes:function(a){var b=this,c=[];return a=a||[],K(a)||(a=[a]),b._processData(a),F(a,function(a){var d=a.id,e=b.nodeById[d];e instanceof O||(a=new O(a),b.nodes.push(a),c.push(a),b.nodeById[a.id]=a)}),b._processNodes(c),b.eachNode(function(a){a.render()}),b.eachNode(function(a){a.load()}),b},addNode:function(a){return this.addNodes([a])},
removeNodes:function(a){var b,c=this;return K(a)||(a=[a]),c.eachNode(a,function(a){delete c.nodeById[a.id],(b=a.parent)&&b.removeChild(a)}),c.nodes=E(c.nodes,a),c.selectedNodes=E(c.selectedNodes,a),F(a,function(a){c.removeNodes(a.children),a.destroy()}),c},queryNodes:function(b){var c=this;return K(b)?b:a.isPlainObject(b)?a.filter(c.nodes,function(a){return o(a,b)}):void 0},eachNode:function(b,c){var d=this,e=[];return a.isFunction(b)?(e=d.nodes,c=b):e=d.queryNodes(b),F(e,function(a){c(a)}),d},expandNodes:function(){},getDraggable:null,getDroppable:null,getExpanderIconClass:null,getExpanderText:null,getIconClass:null,getLabel:null,getTitle:null,beforeMove:function(a,b,c){c(a,b)},onClick:function(){},onContextmenu:function(){},onDblclick:function(){},onRightClick:function(){},onExpand:function(){},onSelect:function(){},onMove:function(){}});return Q.Node=O,Q}),define("all-ui-modules",["pastry/module/loader","pastry/fmt/vsprintf","pastry/fmt/camelCase","pastry/color/Color","pastry/encoding/json","pastry/text/template","pastry/oop/declare","pastry/html/escape","pastry/dom/hotkey","pastry/io/fetch","pastry/ui/Collapse","pastry/ui/Notify","pastry/ui/Tooltip","pastry/ui/Tree"],function(){});